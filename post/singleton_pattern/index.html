<!DOCTYPE html>
<html>
    <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1">
    <title>Singleton Pattern - 잠들지 않는 시간</title>

    <style type="text/css">
        img.wp-smiley,
        img.emoji {
            display: inline !important;
            border: none !important;
            box-shadow: none !important;
            height: 1em !important;
            width: 1em !important;
            margin: 0 .07em !important;
            vertical-align: -0.1em !important;
            background: none !important;
            padding: 0 !important;
        }
    </style>
    <link rel='stylesheet' href='https://lisianthuss.github.io/css/style.css' type='text/css' media='all' />
    <link rel='stylesheet' href='https://lisianthuss.github.io/css/custom.css' type='text/css' media='all' />
        
</head>
    <body class="two-column">
        <a href="#content">Skip to content</a>
<div class="wrapper">
    <header role="banner" class="banner widgets columns-1">
        <a href="/" rel="home">
            <h1 class="site">잠들지 않는 시간</h1>
            <p></p>
        </a>
        <nav role="navigation" aria-label="Primary Navigation">

            <ul class="menu">
                <li class="menu-item "><a class="menu__link" href="/about/">ABOUT</a></li>
                <li class="menu-item "><a class="menu__link" href="/post/">POSTS</a></li>
            </ul>
            <select onChange="location.href=value;">
                <option value="/about/" class="menu-item menu-item-type-custom menu-item-object-custom" >ABOUT</option>
                <option value="/post/" class="menu-item menu-item-type-custom menu-item-object-custom" >POSTS</option>
            </select>
        </nav>
    </header>

    <br>
    <div style="width: 100%; max-height: 100px; text-align: center;">
       
</div>

    <div class="breadcrumbs">
        
    </div>
        <div id="content" class="content">

<main role="main">
    <article role="article" class="post type-post format-standard hentry">
        <header class="post-header">
            <h1>Singleton Pattern</h1>
            <div class="post-details">
                <a rel="bookmark">
                    <time datetime="2020-03-03T33:928:316">2020-03-03</time>
                </a>
				
<span style="float: right;">
    <div id="fb-root" style="height: 100%;"></div>
    
    <script async defer crossorigin="anonymous" src="https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v3.2"></script>
    
    <div class="fb-share-button" data-href="https://lisianthuss.github.io/post/singleton_pattern/" data-layout="button_count" data-size="small">
        <a target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2flisianthuss.github.io%2fpost%2fsingleton_pattern%2f" class="fb-xfbml-parse-ignore">Share</a>
    </div>
    &nbsp;
    <a href="https://twitter.com/share?ref_src=twsrc%5Etfw" class="twitter-share-button" data-text="Singleton Pattern" data-url="https://lisianthuss.github.io/post/singleton_pattern/" data-show-count="false">Tweet</a>
    <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
    &nbsp;
    
</span>

            </div>
        </header>

        <div class="post-content">
            <blockquote>
<p>인스턴스가 하나만 생성되는 것을 보장하며 어디에서든 이 인스턴스에 접근할 수 있는 디자인 패턴이다</p>
</blockquote>
<p><img src="/img/singleton.svg" alt="singleton"></p>
<h2 id="예제--프린터-관리자-만들기-">예제 ( 프린터 관리자 만들기 )</h2>
<h3 id="1-단-하나의-프린터객체만-생성해-어디서든-참조할-수-있게-해보자">1. 단 하나의 프린터(객체)만 생성해 어디서든 참조할 수 있게 해보자.</h3>
<p>new Printer() 가 호출되지 않도록 생성자를 private로 변경하고, 한 번만 호출되도록 getPrinter에 static 속성을 부여하면, Printer 인스턴스가 생성된 상황이라면 그 인스턴스를 반환하며, 없다면 새로 생성해서 반환한다.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Printer</span> <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> Printer printer <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
    <span style="color:#66d9ef">private</span> <span style="color:#a6e22e">Printer</span><span style="color:#f92672">()</span> <span style="color:#f92672">{}</span>
    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> Printer <span style="color:#a6e22e">getPrinter</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">if</span> <span style="color:#f92672">(</span>printer <span style="color:#f92672">==</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">)</span>
            printer <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Printer<span style="color:#f92672">();</span>

        <span style="color:#66d9ef">return</span> printer<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>

    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> <span style="color:#a6e22e">print</span><span style="color:#f92672">(</span>Resource r<span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
        <span style="color:#f92672">...</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
</code></pre></div><h3 id="2-문제점">2. 문제점</h3>
<p>race condition 발생</p>
<blockquote>
<p>메모리와 같은 동일한 자원을 2개 이상의 스레드가 이용하려고 하는 현상</p>
</blockquote>
<p>printer 변수가 null인 것을 확인하고 스레드 A 가 인스턴스를 생성할 때, 동시에 스레드 2도 null인 것을 확인하고 인스턴스를 생성하려고 시도할 수 있다. 결국 두 개의 인스턴스가 생성된다.</p>
<h3 id="3-해결책">3. 해결책</h3>
<ul>
<li>정적 변수에 인스턴스를 만들어 바로 초기화하는 방법</li>
<li>인스턴스를 만드는 method에 동기화하는 방법</li>
</ul>
<h4 id="31-정적-변수에-인스턴스를-만들어-바로-초기화하는-방법">3.1 정적 변수에 인스턴스를 만들어 바로 초기화하는 방법</h4>
<p>정적 변수는 객체가 생성되기 전 클래스가 메모리에 로딩될 때 만들어져 초기화가 한 번만 실행된다.<br>
따라 중복 생성 없이 이미 생성된 printer를 반환할 수 있다.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Printer</span> <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> Printer printer <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> Printer<span style="color:#f92672">();</span>
    prinvate <span style="color:#a6e22e">Printer</span><span style="color:#f92672">()</span> <span style="color:#f92672">{}</span>

    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> Printer <span style="color:#a6e22e">getPrinter</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">return</span> printer<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
</code></pre></div><h4 id="32-인스턴스를-만드는-method에-동기화하는-방법">3.2 인스턴스를 만드는 method에 동기화하는 방법</h4>
<p>다중 스레드 환경에서 동시에 여러 스레드가 getPrinter method를 소유하는 객체이 접근하는 것을 방지하지한다.</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">Printer</span> <span style="color:#f92672">{</span>
    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">static</span> Printer printer <span style="color:#f92672">=</span> <span style="color:#66d9ef">null</span><span style="color:#f92672">;</span>
    prinvate <span style="color:#a6e22e">Printer</span><span style="color:#f92672">()</span> <span style="color:#f92672">{}</span>

    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">synchronized</span> <span style="color:#66d9ef">static</span> Printer <span style="color:#a6e22e">getPrinter</span><span style="color:#f92672">()</span> <span style="color:#f92672">{</span>
        <span style="color:#66d9ef">return</span> printer<span style="color:#f92672">;</span>
    <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span>
</code></pre></div><p>참고</p>
<ul>
<li>Java 객체지향 디자인 패턴</li>
</ul>

        </div>



        <footer class="post-footer">
                
                
                
        
                
                
                
        </footer>
        
<table cellspacing="15" style="width:100%; border: none;">
    <tr>
        <td style="text-align: center; border: none; padding: 0px;">
        </td>
        <td style="text-align: center; border: none; padding: 0px;">
        </td>
    </tr>
</table>

        
	
	

    </article>

    
    <nav class="navigation post-navigation" role="navigation">
        <div class="nav-links">
            <div class="nav-previous">
                
                <a class="previous" href="https://lisianthuss.github.io/post/strategy_pattern/"> Strategy Pattern</a>
                
            </div>
            <div class="nav-next">
                
                <a class="next" href="https://lisianthuss.github.io/post/state_pattern/"> State Pattern</a>
                
            </div>
        </div>
    </nav>
    <section>
        
    </section>
    

</main>


        <div class="sidebar1 widgets columns-1">

    <aside>
    
</aside>
    <aside class="widget widget_categories">
        <h2></h2>
        <ul class="widget__list">
        </ul>
    </aside>

    <aside class="widget widget_tag_cloud">
        <h2></h2>
        <div class="tagcloud">
        </div>
    </aside>

    <aside class="widget widget_recent_entries">
        <h2></h2>
        <ul>
            <li>
                <a href="/post/oop_coffee/">OOP 커피 전문점</a>
            </li>
            <li>
                <a href="/post/command_pattern/">Command Pattern</a>
            </li>
            <li>
                <a href="/post/state_pattern/">State Pattern</a>
            </li>
            <li>
                <a href="/post/singleton_pattern/">Singleton Pattern</a>
            </li>
            <li>
                <a href="/post/strategy_pattern/">Strategy Pattern</a>
            </li>
        </ul>
    </aside>

    <aside class="widget widget_archive">
        <h2></h2>
        <ul>
        </ul>
    </aside>

</div>
        </div>
        </div>
<footer role="contentinfo" class="document-footer contentinfo widgets columns-1">

    <aside class="widget widget_text">
        <div class="textwidget">
            <p>© 잠들지 않는 시간 / Powered by <a href="https://gohugo.io" target="_blank">Hugo</a> with theme <a href="https://github.com/tosi29/inkblotty" target="_blank">Inkblotty</a></p>
        </div>
    </aside>
</footer>
</div>

    </body>
</html>
